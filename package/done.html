<!DOCTYPE html>
<html>
<head>
<title>SmartHost</title>
<meta charset="gb2312" />
<meta http-equiv="content-type" content="text/html; charset=gb2312"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="author" content="mooringniu" />
<meta name="url" content="http://code.google.com/p/smarthost" />
<meta name="description" content="SmartHost A Remote IP/Host Remap Plugin for Fiddler" />
<style type="text/css">
body{
    margin:0px;padding:0px;
    line-height:1.6em;
    font-size:1.3em;
    font-weight:600;
    text-align:center;
    text-decoration:none;
    max-width:device-width;min-width:320px;
}
h1{margin:0;}
button{ width:90%; line-height:1.2em;font-size:1.2em;margin-bottom:0.6em;}
</style>
</head>
<body>
<h1>Done</h1>
<hr/>
<a href="http://localhost/" target="_blank">localhost</a><br/>
<span holder></span>
<button onclick="goBack();return false;" href="javascript:void(0);">GO BACK</button>
<script type="text/javascript">
function goBack(){
    location.href = location.href;
}
function setData(){
    var frag = document.createDocumentFragment(),
        span = document.getElementsByTagName('span')[0],
        a = document.getElementsByTagName('a'),
        localData = '',
        sNames = {};
    for(var i=0,il=a.length;i<il;i++){
        if(a[i].href){
            sNames[a[i].href] = true;
        }
    }
    for(var i in cks){
        var url = 'http://'+i+'/';
        if(url in sNames){ continue; }
        var s = document.createElement('a'),
            b = document.createElement('br');
        s.target="_blank";
        s.href = url;
        s.innerHTML = i;
        frag.appendChild(s);
        frag.appendChild(b);
    }
    if('localStorage' in window){
        localData = localStorage.getItem('localData');
        if(localData!=null){
            localData = splitCookies(localData);
            for(var j in localData){
                if(j in cks){ continue; }
                var s = document.createElement('a'),
                    b = document.createElement('br');
                s.href = 'http://'+j+'/';
                s.target="_blank";
                s.innerHTML = j;
                frag.appendChild(s);
                frag.appendChild(b);
            }
        }
    }
    span.parentNode.insertBefore(frag,span);
}
function splitQueryString(str){
    var strArr = str.split(/&+/gi),obj = {};
    for(var i=0,il=strArr.length; i<il; i++){
        var sp = strArr[i].split(/=+/gi);
        if(sp.length==2){
            obj[sp[0]] = sp[1];
        }
    }
    return obj;
}
function splitCookies(str) {
    var cookies = str.split(/;\s*/gi),ckObj = {};
    for(var i =0,il=cookies.length; i<il; i++){
        var obj = splitQueryString(cookies[i]);
        for(var j in obj){
            if(/[\w\d]+\.[\w\d]+/.test(j)){
                ckObj[j] = obj[j];
            }
        }
    }
    return ckObj;
}
(function(){
    var ck = document.cookie;
    cks = splitCookies(ck);
    setData();
})();
</script>
</body>
</html>
